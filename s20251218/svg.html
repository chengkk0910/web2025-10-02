<!DOCTYPE html>
<html>

<head>
    <title>K 線圖 - 0050</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .chart-container {
            font: 10px sans-serif;
            margin: 20px;
            text-align: center;
        }

        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
            /* 確保線條清晰 */
        }

        .grid line {
            stroke: #ddd;
            /* 網格線顏色 */
            opacity: 0.7;
        }

        .candlestick {
            stroke: black;
        }

        /* 陽線（紅）：收盤價 > 開盤價 */
        .candlestick.up {
            fill: #d32f2f;
            /* 紅色 */
            stroke: #d32f2f;
        }

        /* 陰線（綠）：收盤價 < 開盤價 */
        .candlestick.down {
            fill: #4caf50;
            /* 綠色 */
            stroke: #4caf50;
        }

        /* 影線 */
        .wick {
            stroke-width: 1;
        }

        .ma-line {
            fill: none;
            stroke: blue;
            stroke-width: 1.5;
        }
    </style>
</head>

<body>
    <div class="chart-container">
        <h2>0050 K 線圖（D3.js + SVG）</h2>
        <svg id="candlestick-chart"></svg>
    </div>

    <script>
        // 1. 內嵌 JSON 數據內容
        const rawDataString = `[
  {
    "time": "2005-06-01",
    "open": 11.82499975,
    "high": 11.8999995,
    "low": 11.7475005,
    "close": 11.8950005,
    "MA": ""
  },
  {
    "time": "2005-07-01",
    "open": 11.82499975,
    "high": 12.375,
    "low": 11.70250025,
    "close": 12.0424995,
    "MA": ""
  },
  {
    "time": "2005-08-01",
    "open": 12.0825005,
    "high": 12.4624995,
    "low": 11.63,
    "close": 11.67500025,
    "MA": ""
  },
  {
    "time": "2005-09-01",
    "open": 11.835,
    "high": 12.00749975,
    "low": 11.44999975,
    "close": 11.86250025,
    "MA": ""
  },
  {
    "time": "2005-10-03",
    "open": 11.9375,
    "high": 12,
    "low": 10.9825,
    "close": 11.38,
    "MA": ""
  },
  {
    "time": "2005-11-01",
    "open": 11.38,
    "high": 12.2475005,
    "low": 11.38,
    "close": 12.17500025,
    "MA": ""
  },
  {
    "time": "2005-12-01",
    "open": 12.28499975,
    "high": 12.8999995,
    "low": 12.18000025,
    "close": 12.8125,
    "MA": ""
  },
  {
    "time": "2006-01-02",
    "open": 12.61250025,
    "high": 13.3125,
    "low": 12.6000005,
    "close": 12.8374995,
    "MA": ""
  },
  {
    "time": "2006-02-01",
    "open": 12.8374995,
    "high": 13.625,
    "low": 12.75,
    "close": 13.1000005,
    "MA": 12.197777861111112
  },
  {
    "time": "2006-03-01",
    "open": 13.0874995,
    "high": 13.625,
    "low": 12.6000005,
    "close": 13.19999975,
    "MA": 12.342777777777778
  },
  {
    "time": "2006-04-03",
    "open": 13.19999975,
    "high": 14.26249975,
    "low": 13.1625005,
    "close": 14.19999975,
    "MA": 12.582500027777778
  },
  {
    "time": "2006-05-01",
    "open": 14.19999975,
    "high": 14.82499975,
    "low": 13.17500025,
    "close": 13.3500005,
    "MA": 12.768611166666666
  },
  {
    "time": "2006-06-01",
    "open": 13.3125,
    "high": 13.57499975,
    "low": 12.3500005,
    "close": 13.2749995,
    "MA": 12.925555527777778
  },
  {
    "time": "2006-07-03",
    "open": 13.30000025,
    "high": 13.38749975,
    "low": 12.32499975,
    "close": 12.8500005,
    "MA": 13.088888916666667
  },
  {
    "time": "2006-08-01",
    "open": 12.875,
    "high": 13.7250005,
    "low": 12.80000025,
    "close": 13.5625,
    "MA": 13.243055555555555
  },
  {
    "time": "2006-09-01",
    "open": 13.5375005,
    "high": 14.2875005,
    "low": 13.51249975,
    "close": 14.0874995,
    "MA": 13.384722166666666
  },
  {
    "time": "2006-10-02",
    "open": 14.11250025,
    "high": 14.55000025,
    "low": 13.2250005,
    "close": 13.3500005,
    "MA": 13.441666722222221
  },
  {
    "time": "2006-11-01",
    "open": 13.32499975,
    "high": 14.07499975,
    "low": 13.2250005,
    "close": 14.07499975,
    "MA": 13.549999972222222
  },
  {
    "time": "2006-12-01",
    "open": 14.1000005,
    "high": 14.4375,
    "low": 13.6625005,
    "close": 14.4375,
    "MA": 13.6875
  },
  {
    "time": "2007-01-01",
    "open": 14.4375,
    "high": 14.73750025,
    "low": 14.0375005,
    "close": 14.17500025,
    "MA": 13.684722277777778
  },
  {
    "time": "2007-02-01",
    "open": 14.32499975,
    "high": 14.55000025,
    "low": 14.13749975,
    "close": 14.4375,
    "MA": 13.805555555555555
  },
  {
    "time": "2007-03-01",
    "open": 14.125,
    "high": 14.36250025,
    "low": 13.26249975,
    "close": 14.11250025,
    "MA": 13.898611194444443
  },
  {
    "time": "2007-04-02",
    "open": 14.1875,
    "high": 14.63749975,
    "low": 14.07499975,
    "close": 14.2250005,
    "MA": 14.05138897222222
  },
  {
    "time": "2007-05-01",
    "open": 14.2250005,
    "high": 15.0625,
    "low": 14.2250005,
    "close": 14.9375,
    "MA": 14.204166749999999
  },
  {
    "time": "2007-06-01",
    "open": 14.9375,
    "high": 16.5874995,
    "low": 14.9375,
    "close": 16.25,
    "MA": 14.444444583333333
  },
  {
    "time": "2007-07-02",
    "open": 16.25,
    "high": 17.4624995,
    "low": 16.04999925,
    "close": 16.57500075,
    "MA": 14.802777944444443
  },
  {
    "time": "2007-08-01",
    "open": 16.45000075,
    "high": 16.5249995,
    "low": 14.55000025,
    "close": 16.3999995,
    "MA": 15.061111250000002
  },
  {
    "time": "2007-09-03",
    "open": 16.3999995,
    "high": 17.375,
    "low": 16.125,
    "close": 17.26250075,
    "MA": 15.375000222222221
  },
  {
    "time": "2007-10-01",
    "open": 17.45000075,
    "high": 18.07500075,
    "low": 16.92499925,
    "close": 17.54999925,
    "MA": 15.750000111111111
  },
  {
    "time": "2007-11-01",
    "open": 17.6499995,
    "high": 17.67499925,
    "low": 14.9125005,
    "close": 15.44999975,
    "MA": 15.862500083333332
  },
  {
    "time": "2007-12-03",
    "open": 15.48750025,
    "high": 15.92500025,
    "low": 14.01249975,
    "close": 15.36250025,
    "MA": 16.00138897222222
  },
  {
    "time": "2008-01-01",
    "open": 15.32499975,
    "high": 15.38749975,
    "low": 13.3500005,
    "close": 13.73750025,
    "MA": 15.947222277777776
  },
  {
    "time": "2008-02-01",
    "open": 13.86250025,
    "high": 15.2749995,
    "low": 13.67500025,
    "close": 15.2124995,
    "MA": 15.977777777777776
  },
  {
    "time": "2008-03-03",
    "open": 14.8125,
    "high": 16.4624995,
    "low": 14.1625005,
    "close": 15.11250025,
    "MA": 15.851388916666666
  },
  {
    "time": "2008-04-01",
    "open": 15.19999975,
    "high": 16.2875005,
    "low": 15.01249975,
    "close": 15.9750005,
    "MA": 15.784722222222221
  },
  {
    "time": "2008-05-01",
    "open": 16.11249925,
    "high": 16.4125005,
    "low": 15.36250025,
    "close": 15.55000025,
    "MA": 15.690277861111111
  },
  {
    "time": "2008-06-02",
    "open": 15.51249975,
    "high": 15.75,
    "low": 13.67500025,
    "close": 13.75,
    "MA": 15.299999999999999
  },
  {
    "time": "2008-07-01",
    "open": 13.8374995,
    "high": 13.9624995,
    "low": 12.3525,
    "close": 13.1000005,
    "MA": 14.805555694444443
  },
  {
    "time": "2008-08-01",
    "open": 12.92500025,
    "high": 13.9750005,
    "low": 12.80000025,
    "close": 13.4125005,
    "MA": 14.579166888888889
  },
  {
    "time": "2008-09-01",
    "open": 13.3125,
    "high": 13.3125,
    "low": 10.835,
    "close": 11.1499995,
    "MA": 14.11111125
  },
  {
    "time": "2008-10-01",
    "open": 11.3500005,
    "high": 11.43000025,
    "low": 7.275,
    "close": 9.13500025,
    "MA": 13.599722361111112
  },
  {
    "time": "2008-11-03",
    "open": 9.13500025,
    "high": 9.32250025,
    "low": 7.13250025,
    "close": 8.03250025,
    "MA": 12.801944666666666
  },
  {
    "time": "2008-12-01",
    "open": 8,
    "high": 8.5575,
    "low": 7.48750025,
    "close": 8.21749975,
    "MA": 12.0358335
  },
  {
    "time": "2009-01-01",
    "open": 8.59500025,
    "high": 8.71749975,
    "low": 7.5025,
    "close": 7.625,
    "MA": 11.108055666666667
  },
  {
    "time": "2009-02-02",
    "open": 7.59499975,
    "high": 8.34500025,
    "low": 7.59499975,
    "close": 8.26249975,
    "MA": 10.29833338888889
  },
  {
    "time": "2009-03-02",
    "open": 8.125,
    "high": 9.59500025,
    "low": 7.82499975,
    "close": 9.15999975,
    "MA": 9.788333361111112
  },
  {
    "time": "2009-04-01",
    "open": 9.2725,
    "high": 10.5375005,
    "low": 9.2275,
    "close": 10.5375005,
    "MA": 9.50361113888889
  },
  {
    "time": "2009-05-01",
    "open": 11.2749995,
    "high": 12.03499975,
    "low": 10.90750025,
    "close": 12,
    "MA": 9.346666638888891
  },
  {
    "time": "2009-06-01",
    "open": 12.0200005,
    "high": 12.1625005,
    "low": 10.6000005,
    "close": 11.11499975,
    "MA": 9.34277777777778
  },
  {
    "time": "2009-07-01",
    "open": 11.12,
    "high": 12.48499975,
    "low": 11.11250025,
    "close": 12.255,
    "MA": 9.68944441666667
  },
  {
    "time": "2009-08-03",
    "open": 12.2749995,
    "high": 12.5249995,
    "low": 11.7524995,
    "close": 12.11250025,
    "MA": 10.142777750000002
  },
  {
    "time": "2009-09-01",
    "open": 12.11250025,
    "high": 13.75,
    "low": 12.11250025,
    "close": 13.32499975,
    "MA": 10.710277750000001
  },
  {
    "time": "2009-10-01",
    "open": 13.44999975,
    "high": 13.7875005,
    "low": 12.6499995,
    "close": 12.9125005,
    "MA": 11.297777805555556
  },
  {
    "time": "2009-11-02",
    "open": 12.69999975,
    "high": 13.80000025,
    "low": 12.6499995,
    "close": 13.17500025,
    "MA": 11.843611194444446
  },
  {
    "time": "2009-12-01",
    "open": 13.17500025,
    "high": 14.11250025,
    "low": 13.0874995,
    "close": 14.11250025,
    "MA": 12.39388902777778
  },
  {
    "time": "2010-01-01",
    "open": 14.11250025,
    "high": 14.5375005,
    "low": 13.05000025,
    "close": 13.25,
    "MA": 12.695277861111114
  },
  {
    "time": "2010-02-01",
    "open": 13.2875005,
    "high": 13.30000025,
    "low": 12.625,
    "close": 12.88749975,
    "MA": 12.793888944444445
  },
  {
    "time": "2010-03-01",
    "open": 12.875,
    "high": 13.63749975,
    "low": 12.875,
    "close": 13.5625,
    "MA": 13.065833416666669
  },
  {
    "time": "2010-04-01",
    "open": 13.5625,
    "high": 13.98750025,
    "low": 13.4125005,
    "close": 13.69999975,
    "MA": 13.226388944444444
  },
  {
    "time": "2010-05-03",
    "open": 13.625,
    "high": 13.7124995,
    "low": 12.1625005,
    "close": 12.5249995,
    "MA": 13.272222194444446
  },
  {
    "time": "2010-06-01",
    "open": 12.5,
    "high": 13,
    "low": 11.98750025,
    "close": 12.38749975,
    "MA": 13.168055527777778
  },
  {
    "time": "2010-07-01",
    "open": 12.38749975,
    "high": 13.5375005,
    "low": 12.2524995,
    "close": 13.4750005,
    "MA": 13.230555527777778
  },
  {
    "time": "2010-08-02",
    "open": 13.5874995,
    "high": 13.92500025,
    "low": 13.2875005,
    "close": 13.32499975,
    "MA": 13.24722213888889
  },
  {
    "time": "2010-09-01",
    "open": 13.375,
    "high": 14.5375005,
    "low": 13.3374995,
    "close": 14.42500025,
    "MA": 13.281944361111112
  },
  {
    "time": "2010-10-01",
    "open": 14.4750005,
    "high": 14.5249995,
    "low": 13.7749995,
    "close": 14,
    "MA": 13.365277694444446
  },
  {
    "time": "2010-11-01",
    "open": 14.05000025,
    "high": 14.4624995,
    "low": 14.01249975,
    "close": 14.2749995,
    "MA": 13.519444333333334
  },
  {
    "time": "2010-12-01",
    "open": 14.2749995,
    "high": 15.3500005,
    "low": 14.2749995,
    "close": 15.3500005,
    "MA": 13.718055500000002
  },
  {
    "time": "2011-01-03",
    "open": 15.3999995,
    "high": 15.75,
    "low": 14.8500005,
    "close": 15.75,
    "MA": 13.945833305555558
  },
  {
    "time": "2011-02-01",
    "open": 15.76249975,
    "high": 15.80000025,
    "low": 14.61250025,
    "close": 14.875,
    "MA": 14.206944472222224
  },
  {
    "time": "2011-03-01",
    "open": 14.92500025,
    "high": 15.17500025,
    "low": 13.8999995,
    "close": 14.88749975,
    "MA": 14.48472225
  },
  {
    "time": "2011-04-01",
    "open": 14.8999995,
    "high": 15.625,
    "low": 14.69999975,
    "close": 15.5,
    "MA": 14.709722194444446
  },
  {
    "time": "2011-05-02",
    "open": 15.55000025,
    "high": 15.6499995,
    "low": 14.94999975,
    "close": 15.5,
    "MA": 14.95138888888889
  },
  {
    "time": "2011-06-01",
    "open": 15.5,
    "high": 15.61250025,
    "low": 14.30000025,
    "close": 14.7124995,
    "MA": 14.98333325
  },
  {
    "time": "2011-07-01",
    "open": 14.80000025,
    "high": 15.36250025,
    "low": 14.6000005,
    "close": 14.9750005,
    "MA": 15.09166663888889
  },
  {
    "time": "2011-08-01",
    "open": 15.125,
    "high": 15.125,
    "low": 12.6000005,
    "close": 13.63749975,
    "MA": 15.020833333333334
  },
  {
    "time": "2011-09-01",
    "open": 13.76249975,
    "high": 14.0249995,
    "low": 12.32499975,
    "close": 12.9125005,
    "MA": 14.75
  },
  {
    "time": "2011-10-03",
    "open": 12.6875,
    "high": 13.42500025,
    "low": 12.375,
    "close": 13.05000025,
    "MA": 14.45000002777778
  },
  {
    "time": "2011-11-01",
    "open": 13.05000025,
    "high": 13.2124995,
    "low": 11.76249975,
    "close": 12.0200005,
    "MA": 14.13277786111111
  },
  {
    "time": "2011-12-01",
    "open": 12.3999995,
    "high": 12.6499995,
    "low": 11.65250025,
    "close": 12.45250025,
    "MA": 13.86222236111111
  },
  {
    "time": "2012-01-02",
    "open": 12.36250025,
    "high": 13.1000005,
    "low": 12.23499975,
    "close": 12.98750025,
    "MA": 13.583055722222221
  },
  {
    "time": "2012-02-01",
    "open": 13.05000025,
    "high": 14,
    "low": 13,
    "close": 14,
    "MA": 13.416389055555555
  },
  {
    "time": "2012-03-01",
    "open": 13.98750025,
    "high": 14.05000025,
    "low": 13.5,
    "close": 13.7250005,
    "MA": 13.306666944444444
  },
  {
    "time": "2012-04-02",
    "open": 13.7250005,
    "high": 13.7250005,
    "low": 12.9125005,
    "close": 13.01249975,
    "MA": 13.088611305555553
  },
  {
    "time": "2012-05-01",
    "open": 13.0625,
    "high": 13.3374995,
    "low": 12.7,
    "close": 12.82499975,
    "MA": 12.937499944444443
  },
  {
    "time": "2012-06-01",
    "open": 12.875,
    "high": 13.4750005,
    "low": 12.65000025,
    "close": 13.07499975,
    "MA": 12.936111222222221
  },
  {
    "time": "2012-07-02",
    "open": 13.05000025,
    "high": 13.38749975,
    "low": 12.55000025,
    "close": 13.07499975,
    "MA": 13.070833277777776
  },
  {
    "time": "2012-08-01",
    "open": 13.0874995,
    "high": 14.1000005,
    "low": 13.07499975,
    "close": 13.98750025,
    "MA": 13.295277777777777
  },
  {
    "time": "2012-09-03",
    "open": 13.875,
    "high": 14.4750005,
    "low": 13.875,
    "close": 14.4750005,
    "MA": 13.504166666666666
  },
  {
    "time": "2012-10-01",
    "open": 14.5,
    "high": 15.01249975,
    "low": 14.125,
    "close": 14.28749975,
    "MA": 13.738888805555556
  },
  {
    "time": "2012-11-01",
    "open": 14.30000025,
    "high": 14.30000025,
    "low": 13.75,
    "close": 14.07499975,
    "MA": 13.901388888888888
  },
  {
    "time": "2012-12-03",
    "open": 14.1000005,
    "high": 14.6499995,
    "low": 14.1000005,
    "close": 14.4624995,
    "MA": 14.015277638888889
  },
  {
    "time": "2013-01-01",
    "open": 14.4750005,
    "high": 14.51249975,
    "low": 13.5625,
    "close": 13.7875005,
    "MA": 14.020833305555555
  },
  {
    "time": "2013-02-01",
    "open": 13.7875005,
    "high": 14.4750005,
    "low": 13.73750025,
    "close": 14.4,
    "MA": 14.078333333333333
  },
  {
    "time": "2013-03-01",
    "open": 14.36250025,
    "high": 14.36250025,
    "low": 13.92500025,
    "close": 14.2250005,
    "MA": 14.175
  },
  {
    "time": "2013-04-01",
    "open": 14.23749925,
    "high": 14.86249925,
    "low": 14.1875,
    "close": 14.86249925,
    "MA": 14.373611083333333
  },
  {
    "time": "2013-05-01",
    "open": 15.01249975,
    "high": 15.20000075,
    "low": 14.13749975,
    "close": 14.3999995,
    "MA": 14.470833277777776
  },
  {
    "time": "2013-06-03",
    "open": 14.375,
    "high": 14.57499975,
    "low": 13.23750025,
    "close": 13.3125,
    "MA": 14.380555527777778
  },
  {
    "time": "2013-07-01",
    "open": 13.4375,
    "high": 14.4375,
    "low": 13.375,
    "close": 14.41249975,
    "MA": 14.241666666666666
  },
  {
    "time": "2013-08-01",
    "open": 14.3999995,
    "high": 14.5625,
    "low": 13.9375,
    "close": 14.23749925,
    "MA": 14.2180555
  },
  {
    "time": "2013-09-02",
    "open": 14.28749975,
    "high": 14.5375005,
    "low": 14.11250025,
    "close": 14.51249975,
    "MA": 14.240277777777777
  },
  {
    "time": "2013-10-01",
    "open": 14.5249995,
    "high": 14.7124995,
    "low": 14.44999975,
    "close": 14.61250025,
    "MA": 14.298611138888888
  },
  {
    "time": "2013-11-01",
    "open": 14.67500025,
    "high": 14.80000025,
    "low": 14.3999995,
    "close": 14.4750005,
    "MA": 14.331944527777778
  },
  {
    "time": "2013-12-02",
    "open": 14.51249975,
    "high": 14.76249925,
    "low": 14.36250025,
    "close": 14.73750025,
    "MA": 14.227777805555554
  },
  {
    "time": "2014-01-02",
    "open": 14.67500025,
    "high": 14.7124995,
    "low": 14.3500005,
    "close": 14.3999995,
    "MA": 14.261111027777778
  },
  {
    "time": "2014-02-05",
    "open": 14.1000005,
    "high": 14.625,
    "low": 13.8999995,
    "close": 14.57499975,
    "MA": 14.298610972222223
  },
  {
    "time": "2014-03-03",
    "open": 14.44999975,
    "high": 15.0375005,
    "low": 14.375,
    "close": 15.0249995,
    "MA": 14.437499861111112
  },
  {
    "time": "2014-04-01",
    "open": 15.0625,
    "high": 15.51249975,
    "low": 15.05000025,
    "close": 15.25,
    "MA": 14.559722138888889
  },
  {
    "time": "2014-05-02",
    "open": 15.2875005,
    "high": 15.94999975,
    "low": 15.25,
    "close": 15.7749995,
    "MA": 14.761111027777778
  },
  {
    "time": "2014-06-03",
    "open": 15.7875005,
    "high": 16.5,
    "low": 15.69999975,
    "close": 16.48749925,
    "MA": 15.005555333333332
  },
  {
    "time": "2014-07-01",
    "open": 16.5,
    "high": 17.5,
    "low": 16.275,
    "close": 17.4375,
    "MA": 15.34027775
  },
  {
    "time": "2014-08-01",
    "open": 17.42500075,
    "high": 17.92499975,
    "low": 17.20000075,
    "close": 17.8125,
    "MA": 15.700000083333334
  },
  {
    "time": "2014-09-01",
    "open": 17.76249975,
    "high": 17.89999975,
    "low": 16.8999995,
    "close": 17.2250005,
    "MA": 15.99166663888889
  },
  {
    "time": "2014-10-01",
    "open": 17.27499975,
    "high": 17.375,
    "low": 16.5,
    "close": 16.5125,
    "MA": 16.216666694444445
  },
  {
    "time": "2014-11-03",
    "open": 16.32499975,
    "high": 17.3125,
    "low": 16.32499975,
    "close": 17.30000025,
    "MA": 16.551388916666666
  },
  {
    "time": "2014-12-01",
    "open": 17.30000025,
    "high": 17.92499975,
    "low": 17.15000025,
    "close": 17.53749925,
    "MA": 16.920833388888888
  },
  {
    "time": "2015-01-01",
    "open": 17.5625,
    "high": 17.61250025,
    "low": 17.1000005,
    "close": 17.11250025,
    "MA": 17.151388805555554
  },
  {
    "time": "2015-02-02",
    "open": 17.17499975,
    "high": 17.75,
    "low": 17.1625005,
    "close": 17.65000025,
    "MA": 17.29166675
  },
  {
    "time": "2015-03-02",
    "open": 17.67499925,
    "high": 18.0625,
    "low": 17.58750025,
    "close": 17.8125,
    "MA": 17.436111222222222
  },
  {
    "time": "2015-04-01",
    "open": 17.92499975,
    "high": 18.2375,
    "low": 17.6000005,
    "close": 18.0625,
    "MA": 17.60972225
  },
  {
    "time": "2015-05-04",
    "open": 18.0874995,
    "high": 18.275,
    "low": 17.45000075,
    "close": 17.51250025,
    "MA": 17.68055561111111
  },
  {
    "time": "2015-06-01",
    "open": 17.47500025,
    "high": 17.5625,
    "low": 16.95000075,
    "close": 17.07499975,
    "MA": 17.619444416666667
  },
  {
    "time": "2015-07-01",
    "open": 17.0874995,
    "high": 17.20000075,
    "low": 15.6500005,
    "close": 15.9374995,
    "MA": 17.38750011111111
  },
  {
    "time": "2015-08-03",
    "open": 16.03749975,
    "high": 16.03749975,
    "low": 14.80000025,
    "close": 15.3500005,
    "MA": 16.995833444444445
  },
  {
    "time": "2015-09-01",
    "open": 15.2250005,
    "high": 15.75,
    "low": 14.5375005,
    "close": 15.44999975,
    "MA": 16.48611111111111
  },
  {
    "time": "2015-10-01",
    "open": 15.5,
    "high": 16.71250025,
    "low": 15.38749975,
    "close": 16.5125,
    "MA": 16.077777777777777
  },
  {
    "time": "2015-11-02",
    "open": 16.5249995,
    "high": 16.63749975,
    "low": 16.03749975,
    "close": 16.48749925,
    "MA": 15.894444388888888
  },
  {
    "time": "2015-12-01",
    "open": 16.5,
    "high": 17.05000025,
    "low": 16.27499975,
    "close": 16.32499975,
    "MA": 15.824999944444444
  },
  {
    "time": "2016-01-01",
    "open": 16.29999925,
    "high": 16.29999925,
    "low": 14.5249995,
    "close": 15.3125,
    "MA": 15.712500194444443
  },
  {
    "time": "2016-02-01",
    "open": 15.3125,
    "high": 16.3500005,
    "low": 15.2749995,
    "close": 16.1625005,
    "MA": 15.580555749999998
  },
  {
    "time": "2016-03-01",
    "open": 16.0625,
    "high": 16.1625005,
    "low": 15.3374995,
    "close": 15.3999995,
    "MA": 15.454166749999997
  },
  {
    "time": "2016-04-01",
    "open": 15.3999995,
    "high": 15.8374995,
    "low": 14.75,
    "close": 15.7875005,
    "MA": 15.477777944444442
  },
  {
    "time": "2016-05-03",
    "open": 15.73750025,
    "high": 16.38750075,
    "low": 15.51249975,
    "close": 16.36249925,
    "MA": 15.562500027777775
  },
  {
    "time": "2016-06-01",
    "open": 16.4624995,
    "high": 17.48749925,
    "low": 16.17499925,
    "close": 17.13750075,
    "MA": 15.711111194444442
  },
  {
    "time": "2016-07-01",
    "open": 17.20000075,
    "high": 17.6499995,
    "low": 17.01250075,
    "close": 17.3500005,
    "MA": 16.076388916666666
  },
  {
    "time": "2016-08-01",
    "open": 17.375,
    "high": 17.51250025,
    "low": 17.13750075,
    "close": 17.4375,
    "MA": 16.320833333333333
  },
  {
    "time": "2016-09-01",
    "open": 17.4375,
    "high": 17.77499975,
    "low": 17.25,
    "close": 17.77499975,
    "MA": 16.588888916666665
  },
  {
    "time": "2016-10-03",
    "open": 17.80000075,
    "high": 18.0625,
    "low": 17.55000025,
    "close": 17.9124995,
    "MA": 16.8125
  },
  {
    "time": "2016-11-01",
    "open": 17.92499975,
    "high": 18.29999925,
    "low": 17.61250025,
    "close": 17.98750025,
    "MA": 17.151388833333333
  },
  {
    "time": "2016-12-01",
    "open": 18.0625,
    "high": 18.42500075,
    "low": 17.92499975,
    "close": 18.3374995,
    "MA": 17.525
  },
  {
    "time": "2017-01-03",
    "open": 18.41249925,
    "high": 19.1625,
    "low": 18.25,
    "close": 19.125,
    "MA": 17.838888916666666
  },
  {
    "time": "2017-02-01",
    "open": 19.125,
    "high": 19.4624995,
    "low": 18.82499975,
    "close": 19.45000075,
    "MA": 18.151388916666666
  },
  {
    "time": "2017-03-01",
    "open": 19.45000075,
    "high": 19.7124995,
    "low": 19.3374995,
    "close": 19.6500005,
    "MA": 18.49027786111111
  },
  {
    "time": "2017-04-05",
    "open": 19.6625,
    "high": 19.9875,
    "low": 19.5,
    "close": 19.82500075,
    "MA": 18.815277722222222
  },
  {
    "time": "2017-05-02",
    "open": 19.95000075,
    "high": 20.3500005,
    "low": 19.91250025,
    "close": 20.21249975,
    "MA": 19.206944416666667
  },
  {
    "time": "2017-06-01",
    "open": 20.21249975,
    "high": 20.48749925,
    "low": 19.9624995,
    "close": 20.08749975,
    "MA": 19.531944583333334
  },
  {
    "time": "2017-07-03",
    "open": 20.08749975,
    "high": 20.80000025,
    "low": 20.0249995,
    "close": 20.76250075,
    "MA": 19.883333472222223
  },
  {
    "time": "2017-08-01",
    "open": 20.76250075,
    "high": 21.3625005,
    "low": 20.65000025,
    "close": 21.01249975,
    "MA": 20.201388833333333
  },
  {
    "time": "2017-09-01",
    "open": 21.025,
    "high": 21.4624995,
    "low": 20.7375005,
    "close": 21.3374995,
    "MA": 20.518055666666668
  },
  {
    "time": "2017-10-02",
    "open": 21.3374995,
    "high": 21.9000005,
    "low": 21.1625,
    "close": 21.875,
    "MA": 20.873611027777777
  },
  {
    "time": "2017-11-01",
    "open": 21.875,
    "high": 22.0125,
    "low": 21.4375,
    "close": 21.6875,
    "MA": 21.160277833333335
  },
  {
    "time": "2017-12-01",
    "open": 21.7250005,
    "high": 21.76249975,
    "low": 21.2875005,
    "close": 21.5625,
    "MA": 21.41111111111111
  },
  {
    "time": "2018-01-02",
    "open": 21.7875005,
    "high": 22.5625,
    "low": 21.6125005,
    "close": 22.4624995,
    "MA": 21.684722138888888
  },
  {
    "time": "2018-02-01",
    "open": 22.5,
    "high": 22.6125,
    "low": 20.3500005,
    "close": 20.7124995,
    "MA": 21.8305555
  },
  {
    "time": "2018-03-01",
    "open": 20.7124995,
    "high": 20.7875005,
    "low": 19.70000075,
    "close": 20,
    "MA": 20.640277666666673
  },
  {
    "time": "2018-04-02",
    "open": 20.01250075,
    "high": 20.6499995,
    "low": 19.5874995,
    "close": 20.1875,
    "MA": 20.579166638888893
  },
  {
    "time": "2018-05-02",
    "open": 20.20000075,
    "high": 20.8999995,
    "low": 19.95000075,
    "close": 20.36249925,
    "MA": 20.601388722222225
  },
  {
    "time": "2018-06-01",
    "open": 20.375,
    "high": 21.4750005,
    "low": 20.04999925,
    "close": 21.38750075,
    "MA": 20.61111111111111
  },
  {
    "time": "2018-07-02",
    "open": 21.45000075,
    "high": 22.0874995,
    "low": 20.76250075,
    "close": 21.73749925,
    "MA": 20.74166658333333
  },
  {
    "time": "2018-08-01",
    "open": 21.73749925,
    "high": 21.9125005,
    "low": 21.2250005,
    "close": 21.7250005,
    "MA": 20.873611027777777
  },
  {
    "time": "2018-09-03",
    "open": 21.80000025,
    "high": 22.11250025,
    "low": 21.5,
    "close": 21.7125,
    "MA": 21.05694436111111
  },
  {
    "time": "2018-10-01",
    "open": 21.7125,
    "high": 21.7250005,
    "low": 19.25,
    "close": 19.4624995,
    "MA": 20.916666694444445
  },
  {
    "time": "2018-11-01",
    "open": 19.5,
    "high": 19.6500005,
    "low": 18.575,
    "close": 19.28749975,
    "MA": 20.597222388888887
  },
  {
    "time": "2018-12-03",
    "open": 19.23749925,
    "high": 19.27499975,
    "low": 18.275,
    "close": 18.3374995,
    "MA": 20.15833336111111
  },
  {
    "time": "2019-01-01",
    "open": 18.3500005,
    "high": 19.6000005,
    "low": 18.3500005,
    "close": 19.4000005,
    "MA": 19.787499972222223
  },
  {
    "time": "2019-02-01",
    "open": 19.5,
    "high": 20.5625,
    "low": 19.5,
    "close": 20.48749925,
    "MA": 19.516666666666666
  },
  {
    "time": "2019-03-01",
    "open": 20.5,
    "high": 21.3625005,
    "low": 20.42499975,
    "close": 21.3374995,
    "MA": 19.444444583333333
  },
  {
    "time": "2019-04-01",
    "open": 21.4750005,
    "high": 21.9125005,
    "low": 21.3500005,
    "close": 21.6625,
    "MA": 19.48888888888889
  },
  {
    "time": "2019-05-01",
    "open": 21.625,
    "high": 21.7250005,
    "low": 20.3500005,
    "close": 20.825,
    "MA": 19.50138888888889
  },
  {
    "time": "2019-06-03",
    "open": 20.85000025,
    "high": 21.375,
    "low": 20.42499975,
    "close": 21.375,
    "MA": 19.7430555
  },
  {
    "time": "2019-07-01",
    "open": 21.375,
    "high": 21.77499975,
    "low": 21.0874995,
    "close": 21.5,
    "MA": 20.086111083333332
  },
  {
    "time": "2019-08-01",
    "open": 21.5,
    "high": 21.875,
    "low": 20.6000005,
    "close": 21.6500005,
    "MA": 20.437499972222223
  },
  {
    "time": "2019-09-02",
    "open": 21.6000005,
    "high": 22.0625,
    "low": 21.575,
    "close": 22.03749925,
    "MA": 20.7305555
  },
  {
    "time": "2019-10-01",
    "open": 22.075,
    "high": 22.375,
    "low": 21.875,
    "close": 22.1875,
    "MA": 21.116666666666667
  },
  {
    "time": "2019-11-01",
    "open": 22.2,
    "high": 22.3374995,
    "low": 21.82499975,
    "close": 22.25,
    "MA": 21.465277722222222
  },
  {
    "time": "2019-12-02",
    "open": 22.3125,
    "high": 23.3625,
    "low": 22.1625,
    "close": 23.23749925,
    "MA": 21.872222194444446
  },
  {
    "time": "2020-01-01",
    "open": 23.23749925,
    "high": 23.4750005,
    "low": 21.8375005,
    "close": 22.45,
    "MA": 22.144444416666667
  },
  {
    "time": "2020-02-03",
    "open": 22.4624995,
    "high": 22.5,
    "low": 20.72500075,
    "close": 20.875,
    "MA": 22.263888944444444
  },
  {
    "time": "2020-03-02",
    "open": 20.92499925,
    "high": 21.625,
    "low": 17.55000025,
    "close": 18.82499975,
    "MA": 21.886111166666667
  },
  {
    "time": "2020-04-01",
    "open": 18.9000005,
    "high": 20.5625,
    "low": 18.775,
    "close": 20.4750005,
    "MA": 21.39861113888889
  },
  {
    "time": "2020-05-04",
    "open": 20.55000025,
    "high": 21.30000025,
    "low": 20.4624995,
    "close": 21.1000005,
    "MA": 21.05555561111111
  },
  {
    "time": "2020-06-01",
    "open": 21.11249925,
    "high": 22.7124995,
    "low": 21.1000005,
    "close": 22.4750005,
    "MA": 22.031944305555555
  },
  {
    "time": "2020-07-01",
    "open": 22.48749925,
    "high": 27.175,
    "low": 22.48749925,
    "close": 25.95,
    "MA": 22.41249991666667
  },
  {
    "time": "2020-08-03",
    "open": 25.8625,
    "high": 26.4875,
    "low": 24.67499925,
    "close": 25.45,
    "MA": 22.698611027777776
  },
  {
    "time": "2020-09-01",
    "open": 25.6125,
    "high": 26.75,
    "low": 25.0125,
    "close": 25.75,
    "MA": 22.866666666666667
  },
  {
    "time": "2020-10-05",
    "open": 25.8625,
    "high": 26.925,
    "low": 25.675,
    "close": 25.75,
    "MA": 23.229166750000005
  },
  {
    "time": "2020-11-02",
    "open": 25.7875,
    "high": 28.9875,
    "low": 25.575,
    "close": 28.325,
    "MA": 23.913888916666668
  },
  {
    "time": "2020-12-01",
    "open": 28.45,
    "high": 31.3375,
    "low": 28.1875,
    "close": 31.0625,
    "MA": 24.690277777777777
  },
  {
    "time": "2021-01-04",
    "open": 31.025,
    "high": 31.95,
    "low": 29.875,
    "close": 30.2,
    "MA": 25.461111166666667
  },
  {
    "time": "2021-02-01",
    "open": 30.125,
    "high": 33.7,
    "low": 29.9875,
    "close": 33.025,
    "MA": 26.43888886111111
  },
  {
    "time": "2021-03-01",
    "open": 33.0,
    "high": 33.5625,
    "low": 31.25,
    "close": 31.2625,
    "MA": 27.275
  },
  {
    "time": "2021-04-01",
    "open": 31.3500005,
    "high": 34.025,
    "low": 31.3375005,
    "close": 33.775,
    "MA": 28.318055611111113
  },
  {
    "time": "2021-05-03",
    "open": 33.825,
    "high": 34.05,
    "low": 28.5125,
    "close": 29.5625,
    "MA": 28.94166675
  },
  {
    "time": "2021-06-01",
    "open": 29.6125,
    "high": 31.575,
    "low": 29.1375,
    "close": 31.1375,
    "MA": 29.58472227777778
  },
  {
    "time": "2021-07-01",
    "open": 31.125,
    "high": 32.55,
    "low": 30.7,
    "close": 31.75,
    "MA": 30.24861113888889
  },
  {
    "time": "2021-08-02",
    "open": 31.8500005,
    "high": 32.65,
    "low": 31.3375005,
    "close": 32.3125,
    "MA": 30.98194452777778
  },
  {
    "time": "2021-09-01",
    "open": 32.325,
    "high": 32.9625,
    "low": 31.3,
    "close": 31.6374995,
    "MA": 31.643055611111113
  },
  {
    "time": "2021-10-01",
    "open": 31.625,
    "high": 33.0,
    "low": 31.5375,
    "close": 32.48749925,
    "MA": 32.22222230555556
  },
  {
    "time": "2021-11-01",
    "open": 32.5375,
    "high": 33.5625,
    "low": 32.42499975,
    "close": 33.275,
    "MA": 32.74861127777778
  },
  {
    "time": "2021-12-01",
    "open": 33.4000005,
    "high": 34.9000005,
    "low": 33.15,
    "close": 34.9000005,
    "MA": 33.28472225
  },
  {
    "time": "2022-01-03",
    "open": 34.9000005,
    "high": 36.325,
    "low": 34.42499975,
    "close": 35.83749925,
    "MA": 33.82083338888889
  },
  {
    "time": "2022-02-01",
    "open": 35.80000025,
    "high": 36.4000005,
    "low": 34.25,
    "close": 34.4000005,
    "MA": 34.020833333333336
  },
  {
    "time": "2022-03-01",
    "open": 34.5,
    "high": 34.9750005,
    "low": 33.8625,
    "close": 34.45000075,
    "MA": 34.40416663888889
  },
  {
    "time": "2022-04-01",
    "open": 34.5,
    "high": 34.525,
    "low": 32.325,
    "close": 32.58749925,
    "MA": 34.50138883333333
  },
  {
    "time": "2022-05-02",
    "open": 32.55000025,
    "high": 32.9625,
    "low": 29.8500005,
    "close": 31.75,
    "MA": 34.42361111111111
  },
  {
    "time": "2022-06-01",
    "open": 31.83749925,
    "high": 32.48749925,
    "low": 29.875,
    "close": 29.875,
    "MA": 34.204166694444445
  },
  {
    "time": "2022-07-01",
    "open": 29.75,
    "high": 31.80000025,
    "low": 29.5,
    "close": 29.5,
    "MA": 33.166666944444444
  },
  {
    "time": "2022-08-01",
    "open": 29.525,
    "high": 30.575,
    "low": 28.775,
    "close": 29.4,
    "MA": 32.60000027777778
  },
  {
    "time": "2022-09-01",
    "open": 28.875,
    "high": 29.1,
    "low": 25.75,
    "close": 25.8625,
    "MA": 31.43194472222222
  },
  {
    "time": "2022-10-03",
    "open": 25.625,
    "high": 27,
    "low": 24.125,
    "close": 24.76250075,
    "MA": 30.251389250000003
  },
  {
    "time": "2022-11-01",
    "open": 24.7124995,
    "high": 29.2375,
    "low": 24.375,
    "close": 29.0875,
    "MA": 29.636111472222225
  },
  {
    "time": "2022-12-01",
    "open": 29.8,
    "high": 29.875,
    "low": 27.1,
    "close": 27.175,
    "MA": 28.536111444444444
  },
  {
    "time": "2023-01-03",
    "open": 27.175,
    "high": 29.9875,
    "low": 27.175,
    "close": 29.875,
    "MA": 27.848611166666668
  },
  {
    "time": "2023-02-01",
    "open": 29.925,
    "high": 31.025,
    "low": 29.5125,
    "close": 30.0125,
    "MA": 27.561111250000002
  },
  {
    "time": "2023-03-01",
    "open": 29.9625,
    "high": 31.1375,
    "low": 29.875,
    "close": 30.9375,
    "MA": 27.351388833333335
  },
  {
    "time": "2023-04-03",
    "open": 31.025,
    "high": 32.48749925,
    "low": 30.95,
    "close": 32.1125,
    "MA": 27.420833305555556
  },
  {
    "time": "2023-05-02",
    "open": 32.325,
    "high": 35.8875,
    "low": 32.0625,
    "close": 35.875,
    "MA": 27.76666675
  },
  {
    "time": "2023-06-01",
    "open": 36.1375,
    "high": 38.0125,
    "low": 35.825,
    "close": 37.8125,
    "MA": 28.544444527777778
  },
  {
    "time": "2023-07-03",
    "open": 38.0375,
    "high": 39.525,
    "low": 37.5,
    "close": 38.65,
    "MA": 29.61388925
  },
  {
    "time": "2023-08-01",
    "open": 38.5,
    "high": 38.5,
    "low": 37.0375,
    "close": 37.775,
    "MA": 30.702778111111113
  },
  {
    "time": "2023-09-01",
    "open": 37.8125,
    "high": 38.4000005,
    "low": 36.3375005,
    "close": 37.1625,
    "MA": 31.54722238888889
  },
  {
    "time": "2023-10-02",
    "open": 37.1625,
    "high": 38.21249975,
    "low": 36.6000005,
    "close": 37.8,
    "MA": 32.308333583333335
  },
  {
    "time": "2023-11-01",
    "open": 37.95,
    "high": 40.75,
    "low": 37.6625,
    "close": 40.575,
    "MA": 33.17083363888889
  },
  {
    "time": "2023-12-01",
    "open": 40.7,
    "high": 43.1375,
    "low": 40.5875,
    "close": 42.45,
    "MA": 34.205555805555555
  },
  {
    "time": "2024-01-02",
    "open": 42.45,
    "high": 44.8375,
    "low": 41.675,
    "close": 43.8375,
    "MA": 35.319444472222224
  },
  {
    "time": "2024-02-01",
    "open": 44.05,
    "high": 45.3625,
    "low": 43.5,
    "close": 44.975,
    "MA": 36.46388925
  },
  {
    "time": "2024-03-01",
    "open": 45.1000005,
    "high": 47.7,
    "low": 44.575,
    "close": 46.5125,
    "MA": 37.8458335
  },
  {
    "time": "2024-04-01",
    "open": 46.525,
    "high": 47.7875,
    "low": 44.0875,
    "close": 44.8,
    "MA": 39.06527791666667
  },
  {
    "time": "2024-05-01",
    "open": 44.75,
    "high": 46.725,
    "low": 43.525,
    "close": 45.3125,
    "MA": 40.384722500000005
  },
  {
    "time": "2024-06-03",
    "open": 45.3,
    "high": 47.7,
    "low": 44.8125,
    "close": 47.2875,
    "MA": 41.34166680555556
  },
  {
    "time": "2024-07-01",
    "open": 47.5,
    "high": 49.625,
    "low": 46.7,
    "close": 47.45,
    "MA": 42.21527777777778
  },
  {
    "time": "2024-08-01",
    "open": 47.45,
    "high": 47.8125,
    "low": 42.5,
    "close": 45.9875,
    "MA": 41.45555611111112
  },
  {
    "time": "2024-09-02",
    "open": 45.975,
    "high": 50.05,
    "low": 45.75,
    "close": 47.95,
    "MA": 43.051389166666674
  },
  {
    "time": "2024-10-01",
    "open": 47.975,
    "high": 48.0125,
    "low": 44.75,
    "close": 44.9375,
    "MA": 44.05555566666667
  },
  {
    "time": "2024-11-01",
    "open": 44.9875,
    "high": 48.45,
    "low": 44.9875,
    "close": 48.075,
    "MA": 45.10555561111111
  },
  {
    "time": "2024-12-02",
    "open": 48.075,
    "high": 49.6625,
    "low": 47.6625,
    "close": 48.125,
    "MA": 47.25555611111112
  },
  {
    "time": "2025-01-01",
    "open": 48.125,
    "high": 49.2625,
    "low": 47.55,
    "close": 47.55,
    "MA": 47.28888888888888
  },
  {
    "time": "2025-02-03",
    "open": 47.2,
    "high": 47.375,
    "low": 43.05,
    "close": 43.1875,
    "MA": 46.87500055555555
  },
  {
    "time": "2025-03-03",
    "open": 43.4,
    "high": 44.3375,
    "low": 36.25,
    "close": 42.15,
    "MA": 46.53472250000001
  },
  {
    "time": "2025-04-01",
    "open": 43,
    "high": 45.9625,
    "low": 42.3375,
    "close": 44.9375,
    "MA": 46.49027777777778
  },
  {
    "time": "2025-05-02",
    "open": 45.375,
    "high": 45.375,
    "low": 42.0625,
    "close": 43.15,
    "MA": 46.04305555555556
  }
]`;

        const data = JSON.parse(rawDataString);

        // 2. 設定圖表尺寸和邊距
        const margin = { top: 20, right: 30, bottom: 50, left: 60 };
        const width = 1000 - margin.left - margin.right;
        const height = 500 - margin.top - margin.bottom;

        // 3. 數據處理與清洗
        const filteredData = data.filter(d => d.MA !== null && d.MA !== ""); // 移除 MA 為空的值

        filteredData.forEach(d => {
            // 將時間字串轉換為 Date 物件
            d.time = d3.timeParse("%Y-%m-%d")(d.time) || new Date(d.time);
            // 將價格字串（或數值）轉換為數字
            d.open = +d.open;
            d.high = +d.high;
            d.low = +d.low;
            d.close = +d.close;
            d.MA = +d.MA;
        });

        // 4. 建立 SVG 容器
        const svg = d3.select("#candlestick-chart")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        // 5. 定義比例尺 (Scales)

        // X 軸 (時間): 使用 time.scaleTime 處理時間，但這裡數據是月度，使用 scaleBand 確保間距平均
        const x = d3.scaleBand()
            .domain(filteredData.map(d => d.time))
            .range([0, width])
            .paddingInner(0.1)
            .paddingOuter(0.2);

        // Y 軸 (價格): 找出所有價格的最大值和最小值
        const priceMin = d3.min(filteredData, d => Math.min(d.low, d.MA));
        const priceMax = d3.max(filteredData, d => Math.max(d.high, d.MA));

        // 增加一些緩衝空間
        const y = d3.scaleLinear()
            .domain([priceMin * 0.95, priceMax * 1.05])
            .range([height, 0]);

        // 6. 繪製軸線 (Axes)

        // X 軸：只顯示每 12 個 tick (約一年)
        svg.append("g")
            .attr("class", "axis axis--x")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x)
                .tickValues(x.domain().filter((d, i) => i % 12 === 0))
                .tickFormat(d3.timeFormat("%Y-%m")))
            .selectAll("text")
            .style("text-anchor", "end")
            .attr("dx", "-.8em")
            .attr("dy", ".15em")
            .attr("transform", "rotate(-65)");

        // Y 軸：加入網格線
        svg.append("g")
            .attr("class", "axis axis--y")
            .call(d3.axisLeft(y).ticks(10).tickSize(-width).tickPadding(10));

        // 7. 繪製 K 線 (Candlesticks)

        const barWidth = x.bandwidth();

        const candleGroup = svg.selectAll(".candle")
            .data(filteredData)
            .enter()
            .append("g")
            .attr("class", "candle")
            .attr("transform", d => `translate(${x(d.time)}, 0)`); // 將組定位到正確的 x 位置

        // 繪製影線 (Wick: High to Low)
        candleGroup.append("line")
            .attr("class", "wick")
            .attr("x1", barWidth / 2)
            .attr("x2", barWidth / 2)
            .attr("y1", d => y(d.high))
            .attr("y2", d => y(d.low))
            .attr("stroke", d => d.close > d.open ? "#d32f2f" : "#4caf50");

        // 繪製實體 (Body: Open to Close)
        candleGroup.append("rect")
            .attr("class", d => `candlestick ${d.close > d.open ? 'up' : 'down'}`)
            .attr("x", 0)
            .attr("y", d => y(Math.max(d.open, d.close)))
            .attr("width", barWidth)
            .attr("height", d => Math.abs(y(d.open) - y(d.close)) || 1); // 至少 1px 高度

        // 8. 繪製移動平均線 (MA Line)

        const maLine = d3.line()
            .x(d => x(d.time) + barWidth / 2)
            .y(d => y(d.MA));

        svg.append("path")
            .datum(filteredData.filter(d => !isNaN(d.MA))) // 只使用 MA 為數值的數據點繪製線條
            .attr("class", "ma-line")
            .attr("d", maLine);

        // 9. 增加 MA 線的標籤
        svg.append("text")
            .attr("x", width - 5)
            .attr("y", 15)
            .attr("text-anchor", "end")
            .attr("fill", "blue")
            .text("MA 線");
    </script>
</body>

</html>