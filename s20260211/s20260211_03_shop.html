<!DOCTYPE html>
<html lang="en">

<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .box {
            text-align: center;
        }

        .box>img {
            width: 100px;
        }
    </style>
</head>

<body>

    <div class="container mt-3">
        <h2>飲料SHOP</h2>
        <p>從原產地的一株咖啡樹，最終成為您手中的一杯咖啡；我們堅持採購並且烘焙最高品質的咖啡，這是我們一直努力的基本原則；最初的十英呎到最後十英呎的珍貴體驗，為咖啡的故事做了最佳的註解，同時也塑造出咖啡家族的獨特風味及口感特性，閱讀咖啡的故事，可以讓您更瞭解咖啡，豐富您的咖啡體驗。

            1971 年星巴克創立於美國西雅圖派克市場，1987
            年霍華．舒茲(星巴克主席、總裁暨行政總裁)在當地投資者的協助下買下星巴克，同年在加拿大溫哥華開拓門市，為首次進軍國際市場。今日星巴克門市遍佈全球，已是全世界最主要的咖啡烘焙與零售業者，霍華．舒茲先生經營咖啡事業著重在人文特質與品質堅持，強調尊重顧客與員工，並堅持採購全球最好的咖啡豆烘焙製作，提供消費者最佳的咖啡產品與最舒適的消費場所，經營
            Starbucks Coffee 成為當今全球精品咖啡領導品牌，備受國際學者專家推崇，譽為「咖啡王國傳奇」。

            星巴克的企業使命：啟發並滋潤人們的心靈，在每個人、每一杯、每個社區中皆能體現。秉持持續追求卓越以及實踐企業使命與價值觀，我們透過每一杯咖啡的傳遞，將獨特的星巴克體驗帶入每位顧客的生活中。

            更多相關資訊請至 美國星巴克企業網站 www.starbucks.com</p>
        <table class="table table-bordered text-center align-middle">
            <thead>
                <tr>
                    <th width="5%">ID</th>
                    <th width="15%">產品</th>
                    <th width="5%">單價</th>
                    <th width="20%">數量</th>
                    <th>小計</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>
                        <div class="box">
                            <img src="./images/p1.jpg" alt="">
                            <br>
                            抹茶拿鐵
                        </div>
                    </td>
                    <td>200</td>
                    <td>
                        <input type="number" class="form-control input-number" data-price="200" value="1" min="0"
                            max="10">
                    </td>
                    <td>
                        <span class="resultSpan">
                            200
                        </span>
                    </td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>
                        <div class="box">
                            <img src="./images/p2.jpg" alt="">
                            <br>
                            草莓
                        </div>
                    </td>
                    <td>150</td>
                    <td>
                        <input type="number" class="form-control input-number  " data-price="150" value="1" min="0"
                            max="10">
                    </td>
                    <td>
                        <span class="resultSpan">
                            150
                        </span>
                    </td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>
                        <div class="box">
                            <img src="./images/p3.jpg" alt="">
                            <br>
                            咖啡
                        </div>
                    </td>
                    <td>100</td>
                    <td>
                        <input type="number" class="form-control input-number" data-price="100" value="1" min="0"
                            max="10">
                    </td>
                    <td>
                        <span class="resultSpan">
                            100
                        </span>
                    </td>
                </tr>
                <tr>
                    <td colspan="5">
                        <br>
                        <strong>總計： <span id="totalSpan">300</span></strong>
                    </td>
                </tr>


            </tbody>
        </table>
    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        $(document).ready(function () {

            // function
            function calculateTotal() {
                console.log('calculateTotal function ok');
                const resultSpanAll = $('.resultSpan');
                let total = 0;
                $.each(resultSpanAll, function (key, value) {
                    console.log('key', key);
                    console.log('value', value);
                    let tmp = Number($(value).text());
                    // console.log('tmp', tmp);
                    total += tmp;
                });
                console.log('total', total);

                // $('#totalSpan').text(total);
                // total > 500 打8折
                if (total > 500) {
                    total = total * 0.8;
                }

                return total;
            }

            // 1.bind
            // let p1Input = $('#p1Input');
            // let result1Span = $('#result1Span');
            let inputNumber = $('.input-number');
            console.log('inputNumber', inputNumber);

            // 2.action
            inputNumber.change(function (e) {
                // e.preventDefault();
                // console.log($(this).val());
                let tmpValue = $(this).val();
                let tmpPrice = $(this).attr('data-price');
                let tmpTotal = tmpValue * tmpPrice;
                let totolSpan = $('#totalSpan');
                console.log('tmpValue', tmpValue);
                console.log('tmpPrice', tmpPrice);
                console.log('tmpTotal', tmpTotal);
                // result1Span.text(tmpTotal);

                // let tmpTr = $(this).closest('tr');
                // let tmpTr = $(this).parents('tr');
                let tmpTr = $(this).parent().parent();
                let tmpResultSpan = tmpTr.find('.resultSpan');
                tmpResultSpan.text(tmpTotal);
                let getTotal = calculateTotal();
                console.log('getTotal', getTotal);
                totolSpan.text(getTotal);



            });
        });

    </script>
</body>

</html>